---
title: "Report 2"
author: "Vanessa Machuca and Luis Espino "
date: "2/12/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(skimr)
library(ggplot2)
library(dplyr)
library(broom)
library(mosaic)
library(readr)
library(lattice)
require(gridExtra)
```

Our hypothesis is that a linear relationship exists between number of absences (absences) and final grade (G3). More specifically, weâ€™d predict that a negative relationship exists between the two.  

### UNTRANSFORMED VARIABLES ###

absences vs. final grade plot using ggplot

```{r, eval=FALSE}
ggplot(student_por, aes(absences, G3)) + geom_point() + geom_smooth(method='lm') 
```

residual vs. predicted using xyplot
```{r, eval=FALSE}
G3_lm <- lm(G3 ~ absences, data=student_por)
xyplot(rstandard(G3_lm) ~ fitted(G3_lm), pch=18)
```
There seems to be a negative linear relatinoshios between number of absences and final grade. It is slight, though. 


99% CI for slope parameter $\beta_1$

```{r, eval=FALSE}
tidy(G3_lm, conf.int = TRUE, conf.level = 0.99)
```
The CI is (-0.134, 0.0067). It contains zero, so we cannot be confident that the population slope is not zero. That is, there may not be a linear relationship between number of absences and final grade. Let's try transforming the variables, and then removing some outliers.

### REMOVING OUTLIERS ###

Let's remove the final grades for student who were absent 30 or more times - 2 outliers in total.

```{r, eval=FALSE}
student_porfiltered<- filter(student_por, absences < 30)
ggplot(student_porfiltered, aes(absences, G3)) + geom_point() + geom_smooth(method='lm') 
filteredG3_lm <- lm(G3 ~ absences, data=student_por_28)
tidy(filteredG3_lm, conf.int = TRUE, conf.level = 0.99)
```
The 99% CI for the population slope is now (-0.1591,-0.0104). This interval does not contain 0, so we can be confident that the population slope is not zero - there is a linear relationship between number of absences and final grade. Because we looked at a subset of the explanatory variables, though, the model is only appropriate for fewer than 30 absences.

### ASSESS FIT OF MODEL W/O OUTLIERS ###

The data seem to be fairly symmetric about the model line, but lacks constanct variability. We will now compute a prediction interval for an individual response at an interesting x value.  Let's look at x=15.

```{r, eval=FALSE}
newdata = data.frame(absences=15)
predict(filteredG3_lm, newdata, interval="predict")
```

For a student with 15 absences, we get a predicted final grade of 10.9 and prediction interval of (4.58,17.3). This is a very wide interval, as can be expected both of a prediction interval (relative to a CI) and of higher x-value. Now to find the $R^2$. 

```{r, eval=FALSE}
summary(filteredG3_lm)$r.squared
```

We get an $R^2$ value of 0.013. This tells us that number of absences explains 1.3% of variability in final grades - quite a small percentage. 
We expected a stronger linear relationship between number of absences and final grade. That said, it's safe to say that number absences is likely related to other variables in the data set. In the future, then, we'd like to explore colinearity between absences and other variables like travel time, number of past class failures, and quality of family relationships.  We are interesting in exploring the relationship between parent education and student school performance. The former may indicate whether or not a student who grew up in a family environment that promotes education, which might affect that student's performance. 

